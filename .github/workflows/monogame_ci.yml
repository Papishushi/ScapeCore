name: MonoGame Project CI

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Install MonoGame
      run: |
        sudo apt-get update
        sudo apt-get install -y mono-devel mono-dmcs
        wget -q https://github.com/MonoGame/MonoGame/releases/download/v3.8.0/MonoGame.zip
        unzip -q MonoGame.zip
        export PATH=$PATH:$(pwd)/MonoGameSDK/Content/Tools

    - name: Build MonoGame project
      run: |
        dotnet new mgdesktopgl -n MyMonoGameProject
        cd MyMonoGameProject
        dotnet add package git://github.com/Papishushi/ScapeCore.git#main

    - name: Run MonoGame project
      run: |
        cd MyMonoGameProject
        dotnet build
        dotnet run
